# 13. ìºì‹± ë° ì„±ëŠ¥ ê°œì„ 

## Spring Cache (`@Cacheable`, `@CacheEvict`)

Spring CacheëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•´ ìì£¼ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°ì˜ ì¡°íšŒ ê²°ê³¼ë¥¼ **ìºì‹œ**ì— ì €ì¥í•˜ê³  ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì¶”ìƒí™” ê¸°ëŠ¥ì´ë‹¤.
 ì´ë¥¼ í†µí•´ DBë‚˜ API í˜¸ì¶œ ë“± ìƒëŒ€ì ìœ¼ë¡œ ë¹„ìš©ì´ í° ì—°ì‚°ì˜ íšŸìˆ˜ë¥¼ ì¤„ì—¬ì„œ **ì‘ë‹µ ì†ë„ë¥¼ ê°œì„ **í•˜ê³  **ì‹œìŠ¤í…œ ë¶€í•˜ë¥¼ ê°ì†Œ**ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

Spring BootëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Spring Cache abstraction(`org.springframework.cache`)ì„ ì œê³µí•˜ë©°, ë‹¤ì–‘í•œ Cache Provider(ì˜ˆ: Redis, EhCache, Caffeine ë“±)ì™€ ì‰½ê²Œ ì—°ë™í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±ë˜ì–´ ìˆë‹¤.

Spring Cacheì˜ ì£¼ìš” ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œëŠ” `@Cacheable`, `@CacheEvict`, `@CachePut` ë“±ì´ ìˆë‹¤.

------

### @Cacheable

`@Cacheable`ì€ ë©”ì„œë“œ ì‹¤í–‰ ê²°ê³¼ë¥¼ **ìºì‹œì— ì €ì¥**í•˜ê³ ,
 ë‹¤ìŒ ë²ˆ ë™ì¼í•œ ì¸ìì— ëŒ€í•œ í˜¸ì¶œ ì‹œ **ìºì‹œëœ ê°’ì„ ë°˜í™˜**í•˜ë„ë¡ í•œë‹¤.
 ì¦‰, **ì½ê¸°(Read)** ì‹œ ìºì‹œ ì‚¬ìš©ì— í•´ë‹¹í•œë‹¤.

```
@Cacheable(value = "books", key = "#isbn")
public Book findBook(String isbn) {
    simulateSlowService();
    return bookRepository.findByIsbn(isbn);
}
```

- `value` â†’ ìºì‹œ ì´ë¦„ (Cache Managerê°€ ì´ ì´ë¦„ìœ¼ë¡œ Cacheë¥¼ êµ¬ë¶„)
- `key` â†’ ìºì‹œì˜ í‚¤ (ë™ì¼ keyê°€ ìˆì„ ê²½ìš° ìºì‹œì—ì„œ ë°”ë¡œ ë°˜í™˜)
- ì²« í˜¸ì¶œ â†’ `bookRepository.findByIsbn()` ì‹¤í–‰ ê²°ê³¼ë¥¼ ìºì‹œì— ì €ì¥
- ë‘ ë²ˆì§¸ í˜¸ì¶œ â†’ ë™ì¼ isbnì´ë©´ ìºì‹œì—ì„œ ê²°ê³¼ ë°˜í™˜ (ë©”ì„œë“œëŠ” ì‹¤í–‰ ì•ˆë¨)

------

### @CacheEvict

`@CacheEvict`ëŠ” **ìºì‹œì—ì„œ ê°’ì„ ì œê±°**í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.
 ì£¼ë¡œ **ë°ì´í„°ê°€ ë³€ê²½ë  ë•Œ**(ìˆ˜ì •/ì‚­ì œ) ìºì‹œë¥¼ ë¬´íš¨í™”í•˜ì—¬
 ì˜ëª»ëœ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.

```
@CacheEvict(value = "books", key = "#isbn")
public void deleteBook(String isbn) {
    bookRepository.deleteByIsbn(isbn);
}
```

- `deleteBook()` í˜¸ì¶œ ì‹œ í•´ë‹¹ isbnì— ëŒ€í•œ ìºì‹œë„ í•¨ê»˜ ì œê±°ëœë‹¤.
- `allEntries = true`ë¥¼ ì§€ì •í•˜ë©´ **ìºì‹œ ì „ì²´ ì‚­ì œ**ë„ ê°€ëŠ¥í•˜ë‹¤.

```
@CacheEvict(value = "books", allEntries = true)
public void clearCache() {
    // ëª¨ë“  books ìºì‹œë¥¼ ì‚­ì œ
}
```

------

### @CachePut

`@CachePut`ì€ ë©”ì„œë“œëŠ” **í•­ìƒ ì‹¤í–‰ë˜ì§€ë§Œ ê²°ê³¼ëŠ” ìºì‹œì— ì €ì¥**í•œë‹¤.
 `@Cacheable`ì€ ì¡°ê±´ì´ ì¶©ì¡±ë˜ë©´ ë©”ì„œë“œ ì‹¤í–‰ì„ ê±´ë„ˆë›°ì§€ë§Œ,
 `@CachePut`ì€ í•­ìƒ ì‹¤í–‰ëœë‹¤.

ì£¼ë¡œ **ì—…ë°ì´íŠ¸ í›„ ìƒˆë¡œìš´ ê°’ì„ ìºì‹œì— ë°˜ì˜**í•  ë•Œ ì‚¬ìš©í•œë‹¤.

```
@CachePut(value = "books", key = "#book.isbn")
public Book updateBook(Book book) {
    return bookRepository.save(book);
}
```

------

### CacheManagerì™€ CacheProvider

Spring Bootì—ì„œëŠ” ë‹¤ì–‘í•œ CacheProviderì™€ ì—°ë™í•  ìˆ˜ ìˆë‹¤:

- SimpleCacheManager (ê¸°ë³¸, ConcurrentHashMap ê¸°ë°˜ ë©”ëª¨ë¦¬ ìºì‹œ)
- EhCache / EhCache 3
- Caffeine
- RedisCacheManager (Redis ì—°ë™ ì‹œ ì£¼ë¡œ ì‚¬ìš©)
- JCache (JSR-107)

#### ê¸°ë³¸ ì„¤ì • (application.yml)

```
spring:
  cache:
    type: redis
```

í˜¹ì€

```
spring:
  cache:
    type: caffeine
```

------

### Cache ì„¤ì • ì‹œ ì£¼ì˜ì 

- ìºì‹œ ëŒ€ìƒì€ ë°˜ë“œì‹œ **ì •ì ì´ê±°ë‚˜ ìì£¼ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ë°ì´í„°**ì— ì ìš©í•œë‹¤.
- ìºì‹œ ë¬´íš¨í™” ì „ëµì´ ì¤‘ìš”í•˜ë‹¤. ë°ì´í„° ë³€ê²½ ì‹œ ì ì ˆíˆ `@CacheEvict` ë˜ëŠ” `@CachePut`ì„ ì‚¬ìš©í•˜ì—¬ ê´€ë¦¬í•´ì•¼ í•œë‹¤.
- ë©”ëª¨ë¦¬ ìºì‹œ ì‚¬ìš© ì‹œ OOM(OutOfMemory)ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ TTL(Time To Live) ì„¤ì •ì´ í•„ìš”í•˜ë‹¤.
- Redis ë“± ë¶„ì‚° ìºì‹œ ì‚¬ìš© ì‹œ **ë„¤íŠ¸ì›Œí¬ ë¹„ìš©ê³¼ ì¼ê´€ì„± ì´ìŠˆ**ë„ ê³ ë ¤í•´ì•¼ í•œë‹¤.

------

### ê°„ë‹¨í•œ íë¦„ë„

```
ìš”ì²­ ë°œìƒ â†’ ìºì‹œ í™•ì¸
   â””â”€> ìˆìŒ â†’ ìºì‹œëœ ê²°ê³¼ ë°˜í™˜
   â””â”€> ì—†ìŒ â†’ ì‹¤ì œ ë©”ì„œë“œ ì‹¤í–‰ â†’ ê²°ê³¼ ìºì‹œ ì €ì¥ â†’ ë°˜í™˜
```

------

### ì „ì²´ ì˜ˆì œ

```
@Service
public class BookService {

    @Cacheable(value = "books", key = "#isbn")
    public Book findBook(String isbn) {
        simulateSlowService();
        return bookRepository.findByIsbn(isbn);
    }

    @CacheEvict(value = "books", key = "#isbn")
    public void deleteBook(String isbn) {
        bookRepository.deleteByIsbn(isbn);
    }

    @CachePut(value = "books", key = "#book.isbn")
    public Book updateBook(Book book) {
        return bookRepository.save(book);
    }
}
```

------

 ì´ë ‡ê²Œ `@Cacheable`, `@CacheEvict`, `@CachePut`ì„ ì˜ ì¡°í•©í•˜ë©´
 ë³µì¡í•œ ë¡œì§ ì—†ì´ ë¹ ë¥´ê²Œ ìºì‹œ ê¸°ëŠ¥ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.
 ë‹¨, **ìºì‹œì˜ ì¼ê´€ì„± ê´€ë¦¬ ì „ëµ**ì€ ë°˜ë“œì‹œ ëª…í™•í•˜ê²Œ ìˆ˜ë¦½í•´ì•¼ í•œë‹¤.

## Redis ì—°ë™

Spring BootëŠ” **Spring Cache abstraction**ì„ í†µí•´ ë‹¤ì–‘í•œ Cache Providerì™€ ì†ì‰½ê²Œ í†µí•©í•  ìˆ˜ ìˆë‹¤. ê·¸ì¤‘ì—ì„œë„ RedisëŠ” **ê³ ì„±ëŠ¥ ì¸ë©”ëª¨ë¦¬ ë°ì´í„° ì €ì¥ì†Œ**ë¡œì„œ, ë¶„ì‚° ìºì‹œ êµ¬ì¶•ê³¼ í™•ì¥ì„± í™•ë³´ ì¸¡ë©´ì—ì„œ ë§¤ìš° ìœ ìš©í•˜ë‹¤.
ë³¸ ì ˆì—ì„œëŠ” Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ì— Redis Cacheë¥¼ ì ìš©í•˜ëŠ” ê¸°ë³¸ì ì¸ íë¦„ê³¼ êµ¬ì„± ë°©ë²•ì„ ì„¤ëª…í•œë‹¤.

------

### 1ï¸âƒ£ ì˜ì¡´ì„± ì¶”ê°€

Spring Bootì—ì„œëŠ” `spring-boot-starter-data-redis` ìŠ¤íƒ€í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ Redisì™€ì˜ í†µí•©ì„ ì§€ì›í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ **Lettuce í´ë¼ì´ì–¸íŠ¸**ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©°, í•„ìš”ì— ë”°ë¼ Jedisë¡œ êµì²´í•  ìˆ˜ ìˆë‹¤.

#### Maven

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
</dependency>
```

#### Gradle

```
implementation 'org.springframework.boot:spring-boot-starter-data-redis'
```

------

### 2ï¸âƒ£ Redis ì„œë²„ ì¤€ë¹„

Redis ì„œë²„ëŠ” ë¡œì»¬ í™˜ê²½ì— ì„¤ì¹˜í•˜ê±°ë‚˜ Docker ê¸°ë°˜ìœ¼ë¡œ ì‰½ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

#### Docker ì˜ˆì‹œ

```
docker run -p 6379:6379 redis
```

ê¸°ë³¸ í¬íŠ¸ëŠ” `6379`ì´ë©°, ì´ˆê¸° ì„¤ì • ì‹œ ì¸ì¦ ì—†ì´ ì ‘ì† ê°€ëŠ¥í•˜ë‹¤.

------

### 3ï¸âƒ£ Spring Boot ì„¤ì •

Redis ì—°ë™ì„ ìœ„í•œ ê¸°ë³¸ ì„¤ì •ì€ `application.yml` ë˜ëŠ” `application.properties` íŒŒì¼ì— ì‘ì„±í•œë‹¤.

```
spring:
  cache:
    type: redis  # Spring Cacheê°€ Redisë¥¼ CacheManagerë¡œ ì‚¬ìš©
  redis:
    host: localhost
    port: 6379
    # password: your_redis_password (í•„ìš” ì‹œ ì‚¬ìš©)
```

`spring.cache.type=redis` ì„¤ì •ì´ í•µì‹¬ì´ë‹¤. ì´ë¥¼ í†µí•´ **Spring Cache abstraction**ì€ ë‚´ë¶€ì ìœ¼ë¡œ RedisCacheManagerë¥¼ í™œìš©í•˜ê²Œ ëœë‹¤. ğŸ¯

------

### 4ï¸âƒ£ Cache ì–´ë…¸í…Œì´ì…˜ í™œìš©

Spring Cache ì–´ë…¸í…Œì´ì…˜ì€ CacheManager ì„¤ì •ì— ë”°ë¼ ìë™ìœ¼ë¡œ Redisì™€ ì—°ê³„ëœë‹¤.

#### @Cacheable ì˜ˆì‹œ

```
@Cacheable(value = "books", key = "#isbn")
public Book findBook(String isbn) {
    return bookRepository.findByIsbn(isbn);
}
```

ğŸ“Œ ì§€ì •ëœ `value`ëŠ” Redis ë‚´ cache nameì´ë©°, keyëŠ” í•´ë‹¹ ë°ì´í„°ì˜ ê³ ìœ  í‚¤ê°€ ëœë‹¤.

#### @CacheEvict ì˜ˆì‹œ

```
@CacheEvict(value = "books", key = "#isbn")
public void deleteBook(String isbn) {
    bookRepository.deleteByIsbn(isbn);
}
```

ğŸ“Œ ë°ì´í„° ì‚­ì œ ì‹œ ìºì‹œ ë¬´íš¨í™”ë„ ë™ì‹œì— ì´ë£¨ì–´ì§„ë‹¤.

#### @CachePut ì˜ˆì‹œ

```
@CachePut(value = "books", key = "#book.isbn")
public Book updateBook(Book book) {
    return bookRepository.save(book);
}
```

ğŸ“Œ ì—…ë°ì´íŠ¸ í›„ Redisì— ìµœì‹  ë°ì´í„°ë¥¼ ë°˜ì˜í•œë‹¤.

------

### 5ï¸âƒ£ RedisCacheManager ì»¤ìŠ¤í„°ë§ˆì´ì§•

ìƒì„±ë˜ëŠ” Cache í•­ëª©ì˜ ë§Œë£Œ ì‹œê°„(TTL)ì„ ì„¤ì •í•˜ì—¬ **ë¶ˆí•„ìš”í•œ ë©”ëª¨ë¦¬ ì‚¬ìš©**ê³¼ **ë°ì´í„° ì¼ê´€ì„± ë¬¸ì œ**ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ ìœ„í•´ CacheManagerë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•œë‹¤. ğŸ› ï¸

```
@Configuration
@EnableCaching
public class CacheConfig {

    @Bean
    public RedisCacheConfiguration cacheConfiguration() {
        return RedisCacheConfiguration.defaultCacheConfig()
            .entryTtl(Duration.ofMinutes(10))  // TTL 10ë¶„ ì„¤ì •
            .disableCachingNullValues();
    }

    @Bean
    public RedisCacheManager cacheManager(RedisConnectionFactory connectionFactory) {
        return RedisCacheManager.builder(connectionFactory)
            .cacheDefaults(cacheConfiguration())
            .build();
    }
}
```

#### ì£¼ìš” êµ¬ì„± ìš”ì†Œ

- `.entryTtl(Duration)`
   ê°œë³„ ìºì‹œ í•­ëª©ì˜ ìƒëª… ì£¼ê¸° ì„¤ì •.
- `.disableCachingNullValues()`
   `null` ê°’ì€ ìºì‹œ ëŒ€ìƒì—ì„œ ì œì™¸.

ì´ëŸ¬í•œ êµ¬ì„±ì„ í†µí•´ **ì •í™•í•˜ê³  íš¨ìœ¨ì ì¸ ìºì‹œ ì „ëµ**ì„ ì„¤ê³„í•  ìˆ˜ ìˆë‹¤. âœ…

------

### 6ï¸âƒ£ RedisTemplate vs CacheManager

| ëª©ì                      | ì‚¬ìš© API                                 | íŠ¹ì§•                                      |
| ------------------------ | ---------------------------------------- | ----------------------------------------- |
| Spring Cache abstraction | `@Cacheable`, `@CacheEvict`, `@CachePut` | ê³ ìˆ˜ì¤€ ì¶”ìƒí™”, í†µí•© ê´€ë¦¬                  |
| Redis ì§ì ‘ ì œì–´          | `RedisTemplate`                          | Key-Value, List, Hash ë“± ì €ìˆ˜ì¤€ ì œì–´ ê°€ëŠ¥ |

#### RedisTemplate ì‚¬ìš© ì˜ˆì‹œ

```
@Autowired
private RedisTemplate<String, Object> redisTemplate;

public void saveValue(String key, Object value) {
    redisTemplate.opsForValue().set(key, value);
}

public Object getValue(String key) {
    return redisTemplate.opsForValue().get(key);
}
```

RedisTemplateì€ **ìºì‹œ ì™¸ ì¼ë°˜ ë°ì´í„° ì²˜ë¦¬**ì— ìœ ìš©í•˜ë‹¤.
 ì˜ˆë¥¼ ë“¤ì–´ Session ê´€ë¦¬, ë¶„ì‚°ë½, ì¹´ìš´í„° ë“± ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ğŸ—ƒï¸

------

### 7ï¸âƒ£ êµ¬ì„± íë¦„ ìš”ì•½

```
Controller â†’ Service â†’ @Cacheable ë©”ì„œë“œ í˜¸ì¶œ
   â†“
CacheManager í™•ì¸ â†’ Redisì—ì„œ ìºì‹œ í™•ì¸
   â†“
(ìˆìŒ) â†’ Redisì—ì„œ ê°’ ë°˜í™˜
(ì—†ìŒ) â†’ ë©”ì„œë“œ ì‹¤í–‰ â†’ ê²°ê³¼ Redisì— ì €ì¥ í›„ ë°˜í™˜
```

------

### 8ï¸âƒ£ ì£¼ì˜ ì‚¬í•­ âš ï¸

- RedisëŠ” ë©”ëª¨ë¦¬ ê¸°ë°˜ì´ë¯€ë¡œ **ìš©ëŸ‰ ê´€ë¦¬**ê°€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.
- TTL ì „ëµì„ ë°˜ë“œì‹œ êµ¬ì„±í•  ê²ƒ (ì˜êµ¬ ì €ì¥ ì‹œ OOM ìœ„í—˜).
- Key ë„¤ì´ë°ì€ ëª…í™•í•œ prefix ì ìš© ê¶Œì¥ (`appname::cacheName::key` í˜•íƒœ).
- Redis Cluster êµ¬ì„± ì‹œ **Failover** ë° **ë¶„ì‚° ì „ëµ** ê³ ë ¤ í•„ìš”.

------

### ì •ë¦¬í•˜ìë©´:

 âœ… `spring-boot-starter-data-redis` ì¶”ê°€
 âœ… `application.yml` êµ¬ì„±
 âœ… `@Cacheable`, `@CacheEvict`, `@CachePut` í™œìš©
 âœ… RedisCacheManager ì»¤ìŠ¤í„°ë§ˆì´ì§•ìœ¼ë¡œ TTL ì ìš©
 âœ… í•„ìš” ì‹œ RedisTemplate ë³‘í–‰ ì‚¬ìš©

## EhCache, Caffeine ë“± ë¡œì»¬ ìºì‹œ

Spring Bootì—ì„œ ì œê³µí•˜ëŠ” Spring Cache abstractionì€ ë‹¤ì–‘í•œ Cache Providerì™€ ì†ì‰½ê²Œ í†µí•©í•  ìˆ˜ ìˆë‹¤.
 ê·¸ ì¤‘ **EhCache**ì™€ **Caffeine**ì€ JVM ë‚´ì—ì„œ ë™ì‘í•˜ëŠ” **ë¡œì»¬(in-memory) ìºì‹œ**ë¡œì„œ, ë„¤íŠ¸ì›Œí¬ ì§€ì—° ì—†ì´ ë§¤ìš° ë¹ ë¥¸ ì‘ë‹µì„ ì œê³µí•œë‹¤.

ë¡œì»¬ ìºì‹œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ì— ì í•©í•˜ë‹¤:

- ìºì‹œ ë°ì´í„°ê°€ ë…¸ë“œë§ˆë‹¤ ë…ë¦½ì ìœ¼ë¡œ ìœ ì§€ë˜ì–´ë„ ë˜ëŠ” ê²½ìš°
- ë°ì´í„° ì—…ë°ì´íŠ¸ ë¹ˆë„ê°€ ë‚®ê³  ì½ê¸° ìš”ì²­ì´ ë§ì€ ê²½ìš°
- ë„¤íŠ¸ì›Œí¬ I/O ë¶€ë‹´ì„ ì¤„ì´ê³ ì í•˜ëŠ” ê²½ìš°

------

### 1ï¸âƒ£ EhCache êµ¬ì„±

#### 1. ì˜ì¡´ì„± ì¶”ê°€

EhCache 3.xëŠ” JSR-107(JCache) í‘œì¤€ì„ ì§€ì›í•œë‹¤.

```
<dependency>
    <groupId>org.ehcache</groupId>
    <artifactId>ehcache</artifactId>
</dependency>
```

#### 2. application.yml ì„¤ì •

```
spring:
  cache:
    type: jcache
```

#### 3. ehcache.xml êµ¬ì„±

`src/main/resources/ehcache.xml` íŒŒì¼ì„ ì‘ì„±í•œë‹¤.

```
<config xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
        xmlns='http://www.ehcache.org/v3'
        xsi:schemaLocation="http://www.ehcache.org/v3 http://www.ehcache.org/schema/ehcache-core.xsd">

    <cache alias="books">
        <expiry>
            <ttl unit="minutes">10</ttl>
        </expiry>
        <heap>1000</heap>
    </cache>

</config>
```

- `ttl` â†’ í•­ëª©ë‹¹ Time To Live ì„¤ì •
- `heap` â†’ JVM ë‚´ì—ì„œ ìœ ì§€í•  ìµœëŒ€ í•­ëª© ìˆ˜

#### 4. ì‚¬ìš© ì˜ˆì‹œ

```
@Cacheable(value = "books", key = "#isbn")
public Book findBook(String isbn) {
    return bookRepository.findByIsbn(isbn);
}
```

ğŸ“Œ EhCacheëŠ” **ë„¤íŠ¸ì›Œí¬ ì—†ì´ JVM ë‚´ë¶€**ì—ì„œ ë¹ ë¥¸ ì†ë„ë¡œ ìºì‹œ ì œê³µ.

------

### 2ï¸âƒ£ Caffeine êµ¬ì„± ğŸš€

Caffeineì€ ìµœì‹  Java ê¸°ë°˜ìœ¼ë¡œ ê°œë°œëœ ë§¤ìš° ë¹ ë¥¸ ë¡œì»¬ ìºì‹œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.
 Google Guava Cacheì˜ í›„ê³„ë¡œì„œ ì„±ëŠ¥ê³¼ ìœ ì—°ì„±ì´ ë›°ì–´ë‚˜ë‹¤.

#### 1. ì˜ì¡´ì„± ì¶”ê°€

```
<dependency>
    <groupId>com.github.ben-manes.caffeine</groupId>
    <artifactId>caffeine</artifactId>
</dependency>
```

Spring Bootì—ì„œëŠ” `spring-boot-starter-cache`ì— í¬í•¨ëœ CacheManagerê°€ Caffeineê³¼ í†µí•© ê°€ëŠ¥í•˜ë‹¤.

#### 2. application.yml ì„¤ì •

```
spring:
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=1000,expireAfterWrite=10m
```

`spec` ì†ì„±ì—ì„œ **ìµœëŒ€ ì‚¬ì´ì¦ˆ**ì™€ **ë§Œë£Œ ì •ì±…** ë“±ì„ ì„¤ì •í•œë‹¤.

#### 3. ì‚¬ìš© ì˜ˆì‹œ

```
@Cacheable(value = "books", key = "#isbn")
public Book findBook(String isbn) {
    return bookRepository.findByIsbn(isbn);
}
```

#### 4. ê³ ê¸‰ ì„¤ì • (Java Config ì‚¬ìš© ì‹œ)

```
@Configuration
@EnableCaching
public class CacheConfig {

    @Bean
    public CaffeineCacheManager cacheManager() {
        CaffeineCacheManager cacheManager = new CaffeineCacheManager("books");
        cacheManager.setCaffeine(Caffeine.newBuilder()
            .maximumSize(1000)
            .expireAfterWrite(10, TimeUnit.MINUTES));
        return cacheManager;
    }
}
```

------

### 3ï¸âƒ£ EhCache vs Caffeine ë¹„êµ ğŸ§

| í•­ëª©         | EhCache                                       | Caffeine                             |
| ------------ | --------------------------------------------- | ------------------------------------ |
| ë¼ì´ì„ ìŠ¤     | Apache 2.0                                    | Apache 2.0                           |
| ì£¼ìš” ì–¸ì–´    | Java                                          | Java                                 |
| JSR-107 ì§€ì› | O (EhCache 3.x)                               | O                                    |
| ì†ë„         | ë§¤ìš° ë¹ ë¦„                                     | **ë” ë¹ ë¦„** (ìµœì í™”ëœ ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš©) |
| ì‚¬ìš© ìš©ë„    | ì „í†µì  ì—”í„°í”„ë¼ì´ì¦ˆ ì‹œìŠ¤í…œ                    | ìµœì‹  ê³ ì„±ëŠ¥ ì„œë¹„ìŠ¤                   |
| êµ¬ì„± ë°©ë²•    | xml ê¸°ë°˜ êµ¬ì„± ë§ì´ ì‚¬ìš©                       | Java ì½”ë“œ ê¸°ë°˜ êµ¬ì„±ì— ìµœì í™”         |
| íŠ¹ì§•         | ë””ìŠ¤í¬ ì €ì¥ ì§€ì› (off-heap, persistence ê°€ëŠ¥) | ìˆœìˆ˜ ë©”ëª¨ë¦¬ ê¸°ë°˜, ë§¤ìš° ê²½ëŸ‰          |

------

### 4ï¸âƒ£ ë¡œì»¬ ìºì‹œ ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­ âš ï¸

- ë…¸ë“œ ê°„ **ìºì‹œ ì¼ê´€ì„±**ì´ ë³´ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤.
   (ì„œë²„ ë‹¤ì¤‘ ì¸ìŠ¤í„´ìŠ¤ ì‚¬ìš© ì‹œ ìœ íš¨ì„± ë¬¸ì œ ë°œìƒ ê°€ëŠ¥ â†’ í•„ìš” ì‹œ Redis ë“± ë¶„ì‚° ìºì‹œ í™œìš©)
- JVM ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì£¼ì˜. ìµœëŒ€ í¬ê¸°/TTLì„ ë°˜ë“œì‹œ ì„¤ì •í•  ê²ƒ.
- ë¡œì»¬ ìºì‹œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìš©ë„ë¡œ ì í•©:
  - ì½”ë“œ í…Œì´ë¸”, ë§ˆìŠ¤í„° ë°ì´í„° ë“± ë³€ë™ì´ ì ì€ ì •ë³´
  - ì‚¬ìš©ì ê¶Œí•œ ì •ë³´ ë“± ë‹¤ì¤‘ ì¡°íšŒ ì‹œ ë°˜ë³µ ì‚¬ìš©ë˜ëŠ” ë°ì´í„°

------

### 5ï¸âƒ£ êµ¬ì„± íë¦„ ìš”ì•½

```
Controller â†’ Service â†’ @Cacheable ë©”ì„œë“œ í˜¸ì¶œ
   â†“
CacheManager í™•ì¸ â†’ JVM ë‚´ Cache í™•ì¸ (EhCache ë˜ëŠ” Caffeine)
   â†“
(ìˆìŒ) â†’ ìºì‹œì—ì„œ ê°’ ë°˜í™˜
(ì—†ìŒ) â†’ ë©”ì„œë“œ ì‹¤í–‰ â†’ Cacheì— ì €ì¥ í›„ ë°˜í™˜
```

------

### ê²°ë¡ 

 âœ… EhCache: **ì „í†µì **, ë””ìŠ¤í¬ ì§€ì›, ë‹¤ì–‘í•œ ì˜µì…˜ â†’ ì—”í„°í”„ë¼ì´ì¦ˆ ë ˆê±°ì‹œ ì‹œìŠ¤í…œì— ê°•ì 
 âœ… Caffeine: **ìµœì‹ , ê²½ëŸ‰, ì´ˆê³ ì†**, ë©”ëª¨ë¦¬ ê¸°ë°˜ â†’ ê³ ì„±ëŠ¥ API ì„œë²„ì— ì í•©
 âœ… ë‘˜ ë‹¤ Spring Cache abstractionìœ¼ë¡œ ì‰½ê²Œ í†µí•© ê°€ëŠ¥ (`@Cacheable`, `@CacheEvict`, `@CachePut` ì‚¬ìš© ë™ì¼)

## ìŠ¤í”„ë§ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ íŠœë‹

ìŠ¤í”„ë§ ë¶€íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ê°œë°œ ìƒì‚°ì„±ê³¼ ìœ ì—°ì„±ì´ ë›°ì–´ë‚˜ì§€ë§Œ, ê¸°ë³¸ ì„¤ì •ìœ¼ë¡œë§Œ ìš´ì˜í•  ê²½ìš° ì„±ëŠ¥ ì¸¡ë©´ì—ì„œ ë³‘ëª©ì´ë‚˜ ë¹„íš¨ìœ¨ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
 ë³¸ ì ˆì—ì„œëŠ” **ì£¼ìš” íŠœë‹ í¬ì¸íŠ¸**ë¥¼ ë‹¨ê³„ë³„ë¡œ ì„¤ëª…í•˜ë©°, ì‹¤ì œ ìš´ì˜ í™˜ê²½ì—ì„œ ì„±ëŠ¥ ìµœì í™”ë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•œ ì „ëµì„ ì œì‹œí•œë‹¤.

------

### 1ï¸âƒ£ ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë¡œíŒŒì¼ ê´€ë¦¬

- ìš´ì˜ í™˜ê²½ ë³„ë¡œ **profile**ì„ êµ¬ë¶„í•˜ì—¬ ìµœì í™”ëœ ì„¤ì • ì ìš©.

```
spring:
  profiles:
    active: prod
```

ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë‹¤ìŒ ì„¤ì •ì„ profile ë³„ë¡œ ì¡°ì •:

- connection pool í¬ê¸°
- cache ì„¤ì •
- ë¡œê·¸ ë ˆë²¨ (ìµœì†Œí™”)
- GC ì •ì±…
- metrics/monitoring ì„¤ì •

------

### 2ï¸âƒ£ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ìµœì í™”

#### Connection Pool íŠœë‹

Spring BootëŠ” ê¸°ë³¸ì ìœ¼ë¡œ **HikariCP**ë¥¼ ì‚¬ìš©í•œë‹¤.
 HikariCPëŠ” ê³ ì„±ëŠ¥ connection poolì´ë©°, tuning ì‹œ í•µì‹¬ í¬ì¸íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤:

```
spring:
  datasource:
    hikari:
      maximum-pool-size: 30
      minimum-idle: 10
      idle-timeout: 30000
      connection-timeout: 2000
      max-lifetime: 1800000
```

- `maximum-pool-size`: ìµœëŒ€ ì»¤ë„¥ì…˜ ê°œìˆ˜
- `connection-timeout`: ì»¤ë„¥ì…˜ íšë“ ì‹œ ìµœëŒ€ ëŒ€ê¸° ì‹œê°„

âš ï¸ ê³¼ë„í•œ ì»¤ë„¥ì…˜ ê°œìˆ˜ ì„¤ì • ì‹œ DB ìì› ê³ ê°ˆ ìš°ë ¤ê°€ ìˆìŒ. DBì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì²˜ë¦¬ëŸ‰ ê¸°ì¤€ìœ¼ë¡œ ì ì • ê°’ ì‚°ì • í•„ìš”.

#### SQL ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

- Hibernate `show_sql`, `format_sql`, `generate_statistics` í™œìš©
- Slow Query Log í™œì„±í™” (MySQL, PostgreSQL ë“±)
- **Query Plan** ë¶„ì„ (EXPLAIN, ANALYZE)

#### N+1 ë¬¸ì œ í•´ê²°

- `fetch join` ì‚¬ìš©
- `@EntityGraph` í™œìš©
- í•„ìš” ì‹œ QueryDSL, Native Query ì„¤ê³„

------

### 3ï¸âƒ£ ìºì‹± ì „ëµ ì ìš© ğŸš€

íš¨ìœ¨ì ì¸ ìºì‹± ì ìš©ì€ ì„±ëŠ¥ í–¥ìƒì— ë§¤ìš° íš¨ê³¼ì ì´ë‹¤.

#### ì ìš© ëŒ€ìƒ ì˜ˆì‹œ

- ìì£¼ ì¡°íšŒë˜ëŠ” ì°¸ì¡° ë°ì´í„° (ì½”ë“œ í…Œì´ë¸” ë“±)
- ë³µì¡í•œ ì§‘ê³„ ê²°ê³¼
- ì™¸ë¶€ API í˜¸ì¶œ ê²°ê³¼

#### ê¸°ìˆ  ì„ íƒ

- Caffeine â†’ ê³ ì† ë¡œì»¬ ìºì‹œ
- Redis â†’ ë¶„ì‚° ìºì‹œ
- Hybrid êµ¬ì„± (Caffeine + Redis)

#### ì ìš© ë°©ë²•

```
@Cacheable(value = "commonCodes", key = "#codeId")
public CommonCode findCommonCode(Long codeId) {
    return commonCodeRepository.findById(codeId).orElse(null);
}
```

#### ì£¼ì˜ ì‚¬í•­

- ì ì ˆí•œ TTL ì ìš© í•„ìˆ˜
- ë³€ê²½ ë¹ˆë„ê°€ ë†’ì€ ë°ì´í„°ëŠ” ìºì‹± ëŒ€ìƒì—ì„œ ì œì™¸

------

### 4ï¸âƒ£ HTTP ì••ì¶• ë° í—¤ë” ìµœì í™”

#### Gzip ì••ì¶• í™œì„±í™”

```
server:
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/html,text/xml,text/plain
    min-response-size: 1024
```

- **ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ì ˆê°** â†’ ì‘ë‹µ ì†ë„ í–¥ìƒ ğŸš€

#### ETag í™œì„±í™”

```
spring:
  web:
    resources:
      cache:
        use-etag: true
```

- ì •ì  ë¦¬ì†ŒìŠ¤ ìºì‹± ìµœì í™” â†’ ë¸Œë¼ìš°ì € ìºì‹œ í™œìš©

------

### 5ï¸âƒ£ ë¹ˆ ì´ˆê¸°í™” ìµœì í™”

- **@Lazy** ì‚¬ìš©ìœ¼ë¡œ í•„ìš” ì‹œ ë¡œë”©

```
@Bean
@Lazy
public HeavyComponent heavyComponent() {
    return new HeavyComponent();
}
```

- ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì†ë„ ê°œì„ 

------

### 6ï¸âƒ£ ë¹„ë™ê¸° ì²˜ë¦¬ ë° ë³‘ë ¬í™”

#### Async ì ìš©

```
@EnableAsync
@Service
public class AsyncService {

    @Async
    public void processHeavyTask() {
        // Heavy Logic
    }
}
```

- CPU ë°”ìš´ë“œ ì‘ì—…ì´ë‚˜ I/O ì‘ì—…ì„ ë³‘ë ¬í™”í•˜ì—¬ ì²˜ë¦¬ëŸ‰ ì¦ê°€

#### Thread Pool íŠœë‹

```
@Configuration
@EnableAsync
public class AsyncConfig implements AsyncConfigurer {

    @Override
    public Executor getAsyncExecutor() {
        ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor();
        executor.setCorePoolSize(10);
        executor.setMaxPoolSize(50);
        executor.setQueueCapacity(100);
        executor.setThreadNamePrefix("Async-Executor-");
        executor.initialize();
        return executor;
    }
}
```

------

### 7ï¸âƒ£ GC íŠœë‹ ë° JVM ì˜µì…˜ ì„¤ì • â˜•

ì ì ˆí•œ GC ì„¤ì •ì€ **GC Pause Time**ê³¼ Throughputì— í° ì˜í–¥ì„ ì¤€ë‹¤.

ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ JVM ì˜µì…˜ íŠœë‹ì´ ê³ ë ¤ëœë‹¤:

```
-XX:+UseG1GC
-XX:MaxGCPauseMillis=200
-XX:+ParallelRefProcEnabled
-XX:+UnlockExperimentalVMOptions
-XX:+UseStringDeduplication
```

- G1GC ì‚¬ìš© â†’ ì•ˆì •ì ì¸ Pause Time ì œê³µ
- String Deduplication â†’ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

------

### 8ï¸âƒ£ ëª¨ë‹ˆí„°ë§ ë° í”„ë¡œíŒŒì¼ë§ ğŸ”

#### Spring Boot Actuator í™œìš©

```
management:
  endpoints:
    web:
      exposure:
        include: "*"
```

- `/actuator/metrics`, `/actuator/health`, `/actuator/trace`

#### ì™¸ë¶€ ëª¨ë‹ˆí„°ë§ ë„êµ¬

- Prometheus + Grafana
- ELK Stack (Elasticsearch + Logstash + Kibana)
- Zipkin / Jaeger â†’ ë¶„ì‚° ì¶”ì 

#### í”„ë¡œíŒŒì¼ë§ ë„êµ¬

- JFR (Java Flight Recorder)
- VisualVM
- YourKit

------

### 9ï¸âƒ£ ê¸°íƒ€ ê³ ë ¤ ì‚¬í•­

#### Index ìµœì í™”

- ëª¨ë“  Join / Where ì ˆì— ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ì— Index êµ¬ì„± ì—¬ë¶€ í™•ì¸
- Index ê³¼ë‹¤ ì‚¬ìš©ì€ INSERT/UPDATE ì„±ëŠ¥ ì €í•˜ ìœ ë°œ â†’ ì ì ˆí•œ ê· í˜• í•„ìš”

#### API ì‘ë‹µ í¬ê¸° ìµœì í™”

- í•„ìš” í•„ë“œë§Œ ë°˜í™˜ (DTO í™œìš©)
- @JsonIgnore ì‚¬ìš©ìœ¼ë¡œ ë¶ˆí•„ìš”í•œ í•„ë“œ ì œê±°

#### HTTP Connection ì¬ì‚¬ìš©

- RestTemplate / WebClient ì‚¬ìš© ì‹œ Connection Pool êµ¬ì„±

------

### ì¢…í•© ì •ë¦¬ ğŸ—‚ï¸

| íŠœë‹ ì˜ì—­   | ì£¼ìš” ê¸°ë²•                     |
| ----------- | ----------------------------- |
| DB ì—°ê²°     | HikariCP ì„¤ì •, ì¿¼ë¦¬ ìµœì í™”    |
| ìºì‹±        | Caffeine, Redis ì ìš©          |
| HTTP ì„±ëŠ¥   | Gzip, ETag í™œì„±í™”             |
| ë¹ˆ ì´ˆê¸°í™”   | @Lazy ì ìš©                    |
| ë¹„ë™ê¸° ì²˜ë¦¬ | Async + ThreadPool íŠœë‹       |
| JVM         | GC íŠœë‹, String Deduplication |
| ëª¨ë‹ˆí„°ë§    | Actuator, Prometheus, Zipkin  |
| API ì‘ë‹µ    | DTO í™œìš©, í•„ë“œ ìµœì†Œí™”         |

------

**ì„±ëŠ¥ íŠœë‹ì€ ì¼íšŒì„± ì‘ì—…ì´ ì•„ë‹ˆë¼ ì§€ì†ì ì¸ ëª¨ë‹ˆí„°ë§ê³¼ ìµœì í™”ì˜ ê³¼ì •**ì´ë‹¤.
 ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ íŠ¹ì„±ê³¼ íŠ¸ë˜í”½ íŒ¨í„´ì— ë§ëŠ” íŠœë‹ ì „ëµì„ ìˆ˜ë¦½í•˜ê³  ì£¼ê¸°ì ìœ¼ë¡œ ê²€ì¦í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. ğŸš€

## HTTP ì••ì¶•, ETag ì„¤ì •

ìŠ¤í”„ë§ ë¶€íŠ¸ ê¸°ë°˜ì˜ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ë„¤íŠ¸ì›Œí¬ ë¹„ìš© ìµœì í™”ì™€ ì‘ë‹µ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ **HTTP ì••ì¶•**ê³¼ **ETag** í™œìš©ì´ ë§¤ìš° íš¨ê³¼ì ì´ë‹¤.
 ì´ ë‘ ê°€ì§€ëŠ” **ì „ì†¡ íš¨ìœ¨ì„±**ê³¼ **ìºì‹œ ìµœì í™”** ì¸¡ë©´ì—ì„œ ì£¼ìš”í•œ íŠœë‹ í¬ì¸íŠ¸ë¡œ í™œìš©ëœë‹¤.

------

### 1ï¸âƒ£ HTTP ì••ì¶• (Gzip)

#### ê°œìš”

HTTP ì‘ë‹µ ë³¸ë¬¸ì„ Gzip ë“±ì˜ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ì••ì¶•í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ íš¨ê³¼ê°€ ìˆë‹¤:

- ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ ì ˆê°
- í˜ì´ì§€ ë¡œë“œ ì†ë„ í–¥ìƒ
- ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ ì²´ê° ì„±ëŠ¥ ê°œì„  ğŸ“±

#### ìŠ¤í”„ë§ ë¶€íŠ¸ ì„¤ì •

Spring Bootì—ì„œëŠ” `application.yml` ë˜ëŠ” `application.properties`ì—ì„œ ê°„ë‹¨í•˜ê²Œ HTTP ì••ì¶•ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

#### application.yml ì˜ˆì‹œ

```
server:
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/html,text/xml,text/plain,text/css,text/javascript,application/javascript
    min-response-size: 1024
```

#### ì£¼ìš” ì†ì„± ì„¤ëª…

| ì†ì„±ëª…              | ì„¤ëª…                                            |
| ------------------- | ----------------------------------------------- |
| `enabled`           | ì••ì¶• í™œì„±í™” ì—¬ë¶€                                |
| `mime-types`        | ì••ì¶• ëŒ€ìƒ MIME íƒ€ì… ëª©ë¡                        |
| `min-response-size` | ì§€ì • í¬ê¸° ì´ìƒì¸ ê²½ìš°ì—ë§Œ ì••ì¶• ì ìš© (byte ë‹¨ìœ„) |

#### ë™ì‘ íë¦„

```
í´ë¼ì´ì–¸íŠ¸ â†’ ìš”ì²­ ì‹œ `Accept-Encoding: gzip` í—¤ë” í¬í•¨
ì„œë²„ â†’ ì„¤ì •ëœ MIME íƒ€ì… ë° í¬ê¸° ì¡°ê±´ ì¶©ì¡± ì‹œ Gzip ì••ì¶•ëœ ì‘ë‹µ ì „ì†¡
í´ë¼ì´ì–¸íŠ¸ â†’ `Content-Encoding: gzip` ì‘ë‹µ í—¤ë” í™•ì¸ í›„ ì••ì¶• í•´ì œ
```

#### ê²€ì¦ ë°©ë²•

ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬(Network íƒ­)ì—ì„œ ì‘ë‹µ í—¤ë” í™•ì¸:

```
Content-Encoding: gzip
```

ğŸ‘‰ ì„¤ì •ì´ ì ìš©ë˜ì—ˆìŒì„ í™•ì¸ ê°€ëŠ¥.

------

### 2ï¸âƒ£ ETag ì„¤ì • ğŸ·ï¸

#### ê°œìš”

ETag(Entity Tag)ëŠ” HTTP í”„ë¡œí† ì½œì—ì„œ ì œê³µí•˜ëŠ” **ë¦¬ì†ŒìŠ¤ ì‹ë³„ì**ì´ë‹¤.
 ë¦¬ì†ŒìŠ¤ì˜ ë²„ì „ì„ ê³ ìœ í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ìˆìœ¼ë©°, í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ê°„ **íš¨ìœ¨ì ì¸ ìºì‹œ ê´€ë¦¬**ì— í™œìš©ëœë‹¤.

í™œìš© íš¨ê³¼:

- ë™ì¼ ë¦¬ì†ŒìŠ¤ ì¬ìš”ì²­ ì‹œ ë³€ê²½ ì—¬ë¶€ í™•ì¸ ê°€ëŠ¥
- ë¶ˆí•„ìš”í•œ ë°ì´í„° ì¬ì „ì†¡ ë°©ì§€ â†’ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰ ì ˆê°
- ì •ì  ë¦¬ì†ŒìŠ¤(ì´ë¯¸ì§€, CSS, JS ë“±)ì— íŠ¹íˆ ìœ ìš©

#### ë™ì‘ ì›ë¦¬

```
1ï¸âƒ£ ìµœì´ˆ ìš”ì²­
â†’ ì„œë²„ëŠ” ì‘ë‹µ ì‹œ ETag í—¤ë” ì¶”ê°€ (e.g., ETag: "34a64df551429fcc55e4d42a148795d9f25f89d4")

2ï¸âƒ£ ì´í›„ ìš”ì²­ ì‹œ
â†’ í´ë¼ì´ì–¸íŠ¸ëŠ” If-None-Match: "..." í—¤ë” í¬í•¨í•˜ì—¬ ìš”ì²­

3ï¸âƒ£ ì„œë²„ëŠ” ETag ë¹„êµ í›„
â†’ ë³€ê²½ ì—†ìŒ â†’ 304 Not Modified ì‘ë‹µ (ë³¸ë¬¸ ì—†ìŒ)
â†’ ë³€ê²½ë¨ â†’ ìƒˆë¡œìš´ ETagì™€ í•¨ê»˜ ì •ìƒ ì‘ë‹µ
```

#### ìŠ¤í”„ë§ ë¶€íŠ¸ ì„¤ì •

Spring Boot 2.x ì´ìƒì—ì„œëŠ” **ì •ì  ë¦¬ì†ŒìŠ¤ì— ê¸°ë³¸ì ìœ¼ë¡œ ETag ì§€ì›**ì„ ì œê³µí•œë‹¤.

#### application.yml ì˜ˆì‹œ

```
spring:
  web:
    resources:
      cache:
        use-etag: true
```

ë˜ëŠ” `application.properties` ì‚¬ìš© ì‹œ:

```
spring.web.resources.cache.use-etag=true
```

#### ETag ì ìš© ëŒ€ìƒ

- ê¸°ë³¸ì ìœ¼ë¡œ **ì •ì  ë¦¬ì†ŒìŠ¤**(Static Resources) ëŒ€ìƒ:
  - `/static`, `/public`, `/resources`, `/META-INF/resources` ë‚´ ì •ì  ë¦¬ì†ŒìŠ¤
- Controller ë ˆì´ì–´ì˜ ë™ì  ì»¨í…ì¸ ì—ëŠ” ë³„ë„ í•„í„° êµ¬í˜„ í•„ìš”

#### ê²€ì¦ ë°©ë²•

ì‘ë‹µ í—¤ë” í™•ì¸:

```
ETag: "34a64df551429fcc55e4d42a148795d9f25f89d4"
```

í›„ì† ìš”ì²­ ì‹œ:

```
If-None-Match: "34a64df551429fcc55e4d42a148795d9f25f89d4"
```

ì‘ë‹µ:

```
304 Not Modified
```

ğŸ‘‰ ë°ì´í„° ì¬ì „ì†¡ ì—†ì´ ìƒíƒœ ì½”ë“œë§Œ ì „ì†¡ â†’ íŠ¸ë˜í”½ ì ˆê° ğŸ’¨

------

### 3ï¸âƒ£ HTTP ì••ì¶•ê³¼ ETagì˜ ê´€ê³„

- HTTP ì••ì¶•ì€ **ì‘ë‹µ ë³¸ë¬¸ í¬ê¸°**ë¥¼ ì¤„ì„.
- ETagëŠ” **ìºì‹œ ì ì¤‘ ì—¬ë¶€**ë¥¼ íŒë‹¨.

ë‘˜ì€ **ì„œë¡œ ë³´ì™„ì ì¸ ì—­í• **ì„ í•˜ë©° ë™ì‹œì— ì ìš© ê°€ëŠ¥í•˜ë‹¤:

- ë³€ê²½ ì—†ëŠ” ë¦¬ì†ŒìŠ¤ëŠ” **304 ì‘ë‹µ(ETag)** ìœ¼ë¡œ ë¹ ë¥´ê²Œ ì²˜ë¦¬.
- ë³€ê²½ëœ ë¦¬ì†ŒìŠ¤ëŠ” **ì••ì¶• ì ìš©(Gzip)** í›„ ì „ì†¡í•˜ì—¬ ë„¤íŠ¸ì›Œí¬ ë¹„ìš© ìµœì†Œí™”.

ìµœì í™”ëœ ì›Œí¬í”Œë¡œìš°:

```
í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ â†’ ì„œë²„ì—ì„œ ETag ë¹„êµ â†’ ë³€ê²½ ì—†ìŒ â†’ 304 ì‘ë‹µ
ë³€ê²½ë¨ â†’ ì••ì¶• ì ìš©ëœ ìƒˆ ì‘ë‹µ ì „ì†¡
```

------

### ì¢…í•© ì •ë¦¬ ğŸ—‚ï¸

| í•­ëª©             | ê¸°ëŠ¥                     | ê¸°ëŒ€ íš¨ê³¼                                         |
| ---------------- | ------------------------ | ------------------------------------------------- |
| HTTP ì••ì¶• (Gzip) | ì‘ë‹µ ë³¸ë¬¸ ì••ì¶•           | ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ ì ˆê°, ì‘ë‹µ ì†ë„ í–¥ìƒ              |
| ETag             | ë¦¬ì†ŒìŠ¤ ë²„ì „ ê´€ë¦¬ ë° ìºì‹± | ë¶ˆí•„ìš”í•œ ë°ì´í„° ì¬ì „ì†¡ ë°©ì§€, ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰ ì ˆê° |

------

### ì ìš© ì‹œ ì£¼ì˜ì‚¬í•­ âš ï¸

- **ë™ì  ì»¨í…ì¸ ì˜ ê²½ìš° ETag ìë™ ì ìš©ë˜ì§€ ì•ŠìŒ** â†’ í•„ìš” ì‹œ ì»¤ìŠ¤í…€ í•„í„° êµ¬í˜„ í•„ìš”.
- HTTP ì••ì¶•ì€ **CPU ì‚¬ìš©ëŸ‰ ì¦ê°€** ê°€ëŠ¥ì„± ì¡´ì¬ â†’ íŠ¸ë˜í”½ ê·œëª¨ì™€ ì„œë²„ ì„±ëŠ¥ ê³ ë ¤ í›„ ì ìš©.
- ETag ì ìš© ì‹œ **ë¦¬ì†ŒìŠ¤ í•´ì‹œ ë˜ëŠ” LastModified ê¸°ë°˜** ì „ëµ ëª…í™•íˆ ìˆ˜ë¦½.